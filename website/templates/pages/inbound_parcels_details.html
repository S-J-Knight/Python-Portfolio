{% extends 'store/main.html' %}

{% block content %}
<div class="orders-card">
  <h2>Inbound Parcel Details</h2>
  <table class="table" style="width:100%;border-collapse:collapse;margin-top:12px;">
    <tbody>
      <tr><th style="text-align:left;padding:10px;background:#e6f4ea;color:#116944;width:180px;">IP #</th>
          <td style="padding:10px;border-bottom:1px solid #eee;">
            {% if parcel.ip %}{{ parcel.ip }}{% elif parcel.code %}{{ parcel.code }}{% else %}ip{{ parcel.pk }}{% endif %}
          </td></tr>

      <tr><th style="text-align:left;padding:10px;background:#e6f4ea;color:#116944;">Status</th>
          <td style="padding:10px;border-bottom:1px solid #eee;">{{ parcel.get_status_display }}</td></tr>

      <tr><th style="text-align:left;padding:10px;background:#e6f4ea;color:#116944;">Date Submitted</th>
          <td style="padding:10px;border-bottom:1px solid #eee;">
            {% if parcel.date_submitted %}{{ parcel.date_submitted|date:"M d, Y H:i" }}{% else %}-{% endif %}
          </td></tr>

      <tr><th style="text-align:left;padding:10px;background:#e6f4ea;color:#116944;">Materials weighed by Knightcycle</th>
          <td style="padding:10px;border-bottom:1px solid #eee;">
            {% if parcel.materials.all %}
              <ul style="margin:0; padding-left:1.1rem;">
                {% for m in parcel.materials.all %}
                  <li>{{ m.material }}{% if m.weight_kg %} ‚Äî {{ m.weight_kg|floatformat:3 }} kg{% endif %}</li>
                {% endfor %}
              </ul>
            {% else %}-{% endif %}
          </td></tr>

      <tr><th style="text-align:left;padding:10px;background:#e6f4ea;color:#116944;">Notes from Knightcycle</th>
          <td style="padding:10px;border-bottom:1px solid #eee;">
            {% if parcel.admin_comment %}{{ parcel.admin_comment|linebreaksbr }}{% else %}‚Äî{% endif %}
          </td></tr>
      
      <tr><th style="text-align:left;padding:10px;background:#e6f4ea;color:#116944;">Waste Transfer Notice</th>
          <td style="padding:10px;border-bottom:1px solid #eee;">
            {% if parcel.wtn_signed_date %}
              <span style="color: #22c55e; font-weight: 600;">‚úì Signed on {{ parcel.wtn_signed_date|date:"M d, Y" }}</span>
              <br><small style="color: #666;">Reference: {{ parcel.wtn_reference }}</small>
              {% if parcel.estimated_weight %}
              <br><small style="color: #666;">Estimated Weight: {{ parcel.estimated_weight }} kg</small>
              {% endif %}
            {% else %}
              <a href="{% url 'store:waste_transfer_notice' parcel.id %}" 
                 class="btn btn-sm" 
                 style="background: #116944; color: white; padding: 8px 16px; border-radius: 6px; text-decoration: none; display: inline-block; font-weight: 600;">
                üìù Sign Waste Transfer Notice
              </a>
              <br><small style="color: #666; margin-top: 8px; display: block;">Required for legal waste transfer compliance</small>
            {% endif %}
          </td></tr>
    </tbody>
  </table>

  <div style="margin-top:16px;text-align:center;">
    <a class="btn btn-outline-dark" href="{% url 'store:orders' %}">‚Üê Back to Orders</a>
  </div>
</div>
{% endblock %}