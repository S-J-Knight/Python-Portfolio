{% extends 'store/main.html' %}
{% load static %}

{% block content %}
<div class="container py-5 text-center">
  <h1 class="display-4 mb-4">Store Coming Soon</h1>
  <p class="lead mb-4">
    We're working hard to bring you high-quality recycled 3D printing filament.<br>
    Check back soon or sign up for our newsletter to be notified when products are available.
  </p>
  <a href="{% url 'home' %}" class="btn btn-success btn-lg">Back to Home</a>
</div>
{% comment %} <style>
  .stock-badge {
    padding: 4px 10px;
    border-radius: 12px;
    font-size: 0.75rem;
    font-weight: 600;
    display: inline-block;
    margin-top: 8px;
  }
  .stock-badge.in-stock {
    background: #d1fae5;
    color: #065f46;
  }
  .stock-badge.low-stock {
    background: #fef3c7;
    color: #92400e;
  }
  .stock-badge.out-of-stock {
    background: #fee2e2;
    color: #991b1b;
  }
  .recycle-card.out-of-stock-product {
    opacity: 0.6;
  }
  .recycle-card.out-of-stock-product .recycle-img {
    filter: grayscale(50%);
  }
</style>
  <!-- Filter Form -->
  <form method="get" class="form-inline mb-4">
    <label for="product_type" class="mr-2 font-weight-bold">Material:</label>
    <select name="product_type" id="product_type" class="form-control mr-3">
      <option value="">All</option>
      {% for code, label in product_type_choices %}
        <option value="{{ code }}" {% if selected_product_type == code %}selected{% endif %}>{{ label }}</option>
      {% endfor %}
    </select>
    <label for="colour" class="mr-2 font-weight-bold">Colour:</label>
    <select name="colour" id="colour" class="form-control mr-3">
      <option value="">All</option>
      {% for code, label in colour_choices %}
        <option value="{{ code }}" {% if selected_colour == code %}selected{% endif %}>{{ label }}</option>
      {% endfor %}
    </select>
    <button type="submit" class="btn btn-success">Filter</button>
  </form>
<div class="store-grid">
  <div class="row">
    {% for product in products %}
      <div class="col-lg-4 col-md-6 mb-4">
        <article class="recycle-card recycle-card--small {% if not product.is_in_stock %}out-of-stock-product{% endif %}">
          <div class="recycle-media">
            {% if product.image %}
              <a href="{% url 'store:product_detail' product.slug %}">
                <img src="{{ product.image.url }}" alt="{{ product.name }}" class="recycle-img">
              </a>
            {% else %}
              <div class="recycle-img placeholder">No image</div>
            {% endif %}
          </div>

          <div class="recycle-info">
            <h5 class="product-name"><a href="{% url 'store:product_detail' product.slug %}">{{ product.name }}</a></h5>
            <p class="price">Â£{{ product.price|floatformat:2 }}</p>
            <p class="card-text">
              <strong>Material:</strong> {{ product.product_type }}<br>
              <strong>Colour:</strong> {{ product.colour }}
            </p>

            <span class="stock-badge {{ product.stock_status_class }}">
              {{ product.stock_status }}
            </span>

            <div class="actions">
              {% if product.is_in_stock %}
                <input id="qty-{{ product.id }}" class="form-control qty-input" type="number" value="1" min="1" max="{{ product.stock_quantity }}" style="width:120px;margin-right:8px;display:inline-block;">
                <button class="btn btn-success update-cart"
                    data-product="{{ product.id }}"
                    data-action="add"
                    data-qty-input="qty-{{ product.id }}">
                  Add to basket
                </button>
              {% else %}
                <button class="btn btn-secondary" disabled>
                  Out of Stock
                </button>
              {% endif %}
              <a class="btn btn-outline-primary" href="{% url 'store:product_detail' product.slug %}">View</a>
            </div>
          </div>
        </article>
      </div>
    {% empty %}
      <div class="col-12"><p>No products available.</p></div>
    {% endfor %}
  </div>
</div> {% endcomment %}
{% endblock %}